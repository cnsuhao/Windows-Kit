<html><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=utf-8" /><META NAME="save" CONTENT="history" /><title xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">XBAP Hosting Silverlight Sample</title><META NAME="Description" CONTENT="&#xD;&#xA;                    This sample demonstrates the following:&#xD;&#xA;                "></META><META NAME="MS.LOCALE" CONTENT="en-us" /><style>
body
{font-family:Verdana;font-size:medium;}
div#mainSection, div#header
{font-size:70%;width: 100%;}
div#mainBody
{font-size:90%;}
div#mainSection div table
{font-size: 100%;text-align: left;}
span#nsrTitle
{color:#003399;font-size:90%;font-weight:600;}
div#header
{background-color:#D4DFFF;}
.heading
{font-size:120%;color:#003399;}
.subHeading
{font-size:100%;margin-bottom:4;}
li
{margin-top:-2;margin-bottom:3;}
p
{margin-top:10;margin-bottom:5;}
div.tableSection p
{margin-top:1;margin-bottom:4;}	
div#mainSection table th
{background-color:#EFEFF7;color:#000066;text-align:left;}
div#mainSection table td
{background-color:#F7F7FF;}
div#mainSection table
{margin-top:5px;margin-bottom: px;}
			</style></head><body><div id="header"><table width="100%" id="topTable"></table></div><div id="mainSection"><div id="mainBody"><br /><font color="DarkGray">[This readme is a partial copy of the sample's topic in the SDK documentation.]</font><br /><font color="DarkGray" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"></font><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"></p><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><font color="DarkGray">Updated: July 2008</font></p><div class="introduction"><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
                    This sample demonstrates the following:
                </p><ul xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><li><p>
                    How to host a Silverlight-based application in a XAML browser application (XBAP).
                </p></li><li><p>
                    How to communicate between the host XBAP and the hosted Silverlight-based application.
                </p></li></ul></div><h1 class="heading" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><span onclick="ExpandCollapse(sectionToggle0)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle0, event)" tabindex="0">Hosting a Silverlight-Based Application in an XBAP</span></h1><div id="sectionSection0" class="section"><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
                    Silverlight-based applications can be hosted in XBAPs by using the <span sdata="cer" target="T:System.Windows.Controls.WebBrowser">WebBrowser</span> control. The content of a XBAP <span sdata="cer" target="T:System.Windows.Controls.Page">Page</span> contains the <span sdata="cer" target="T:System.Windows.Controls.WebBrowser">WebBrowser</span> control whose source URI identifies the HTML page that hosts the Silverlight-based application. The HTML page uses the Silverlight plug-in control to host the Silverlight-based application.
                </p><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
                    The following image illustrates the high-level architecture for hosting a Silverlight-based application in an XBAP.
                </p><span class="media" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"></span></div><h1 class="heading" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><span onclick="ExpandCollapse(sectionToggle1)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle1, event)" tabindex="0">Communicating from the XBAP to the Silverlight-Based Application</span></h1><div id="sectionSection1" class="section"><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
                    A host XBAP can communicate with a hosted Silverlight-based application via script methods implemented by the HTML page that hosts the Silverlight-based application. An XBAP calls the script methods using the <span sdata="cer" target="Overload:System.Windows.Controls.WebBrowser.InvokeScript">InvokeScript</span> method. The script methods then call methods implemented by a scriptable object that is exposed from the Silverlight-based application and available to script from the <span sdata="langKeyword" value="Content"><span class="keyword">Content</span></span> property of the Silverlight plug-in control.
                </p><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
                    The following figure shows both the high-level architecture for hosting a Silverlight-based application in an XBAP and the key technology used to propagate method calls from a host XBAP to a hosted Silverlight-based application.
                </p><span class="media" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"></span><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
                    To call script methods using the <span sdata="cer" target="T:System.Windows.Controls.WebBrowser">WebBrowser</span> control, see <span sdata="link">WebBrowser Control Sample</span>. For more information on implementing Silverlight-based applications that expose scriptable objects, see Walkthrough: Calling Managed Code from JavaScript. For an introduction to Silverlight-based application development, see Getting Started with Silverlight.
                </p></div><h1 class="heading" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><span onclick="ExpandCollapse(sectionToggle2)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle2, event)" tabindex="0">Communicating from the Silverlight-Based Application to the XBAP</span></h1><div id="sectionSection2" class="section"><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
                    A hosted Silverlight-based application can communicate with a host XBAP via script methods implemented by the HTML page that hosts the Silverlight-based application. A Silverlight-based application calls the script methods using the <span sdata="langKeyword" value="Invoke"><span class="keyword">Invoke</span></span> method of the <span sdata="langKeyword" value="HtmlWindow"><span class="keyword">HtmlWindow</span></span> class (from the Silverlight <span sdata="langKeyword" value="System.Windows.Browser"><span class="keyword">System.Windows.Browser</span></span> namespace). A Silverlight-based application gets a reference to the window (represented by the <span sdata="langKeyword" value="HtmlWindow"><span class="keyword">HtmlWindow</span></span> class) from the <span sdata="langKeyword" value="Window"><span class="keyword">Window</span></span> property of the <span sdata="langKeyword" value="HtmlPage"><span class="keyword">HtmlPage</span></span> class (also in the <span sdata="langKeyword" value="System.Windows.Browser"><span class="keyword">System.Windows.Browser</span></span> namespace). The script methods then call methods implemented by a scriptable object that is exposed by from the XBAP, using the <span sdata="cer" target="P:System.Windows.Controls.WebBrowser.ObjectForScripting">ObjectForScripting</span> property, and available to script from the <span sdata="langKeyword" value="external"><span class="keyword">external</span></span> property of the <span sdata="langKeyword" value="window"><span class="keyword">window</span></span> object that is exposed by the host browser.
                </p><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
                    The following figure shows both the high-level architecture for hosting a Silverlight-based application in an XBAP and the key technology used to propagate method calls from a hosted Silverlight-based application to a host XBAP.
                </p><span class="media" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"></span><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
                    To call script methods from a Silverlight-based application, see Walkthrough: Calling JavaScript from Managed Code. For more information on exposing scriptable objects from XBAPs, see <span sdata="link">WebBrowser Control Sample</span> and <span sdata="cer" target="P:System.Windows.Controls.WebBrowser.ObjectForScripting">ObjectForScripting</span>.
                </p></div><h1 class="heading" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><span onclick="ExpandCollapse(sectionToggle3)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle3, event)" tabindex="0">Configuring the Sample</span></h1><div id="sectionSection3" class="section"><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
                    The sample consists of one solution (XBAPHostingSilverlightSample) with two projects:
                </p><ol xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><li><p>
                    The XBAP project (WPFBrowserApplication) that hosts the Silverlight-based application.
                </p></li><li><p>
                    The Silverlight-based application project (SilverlightApplication).
                </p></li></ol><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
                    SilverlightApplication builds afterWPFBrowserApplication and includes a post-build step that copies the generated Silverlight-based application, silverlightspplication.xap to the WPFBrowserApplication project output folder: \bin\debug.
                </p><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
                    The sample must be configured to run on the <span class="code">localhost</span> from a virtual directory that points to the WPFBrowserApplication project output folder (\bin\debug) using the following steps:
                </p><ol xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><li><p>
                    From <span class="ui">Start | Administrative Tools</span>, choose <span class="ui">Internet Information Services (IIS) Manager</span>.
                </p></li><li><p>
                    Select <span class="ui">Web Sites | Default Web Site</span>.
                </p></li><li><p>
                    Right-click <span class="ui">Default Web Site</span> and choose <span class="ui">Add Virtual Directory</span>, then
                </p><ol><li><p>
                    Set the <span class="ui">Alias</span> to "WPFBrowserApplication".
                </p></li><li><p>
                    Set the <span class="ui">Physical path</span> to the WPFBrowserApplication project output folder.
                </p></li></ol></li><li><p>
                    Press <span class="ui">OK</span> to create the virtual directory.
                </p></li></ol></div><h1 class="heading" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><span onclick="ExpandCollapse(sectionToggle4)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle4, event)" tabindex="0">Running the Sample</span></h1><div id="sectionSection4" class="section"><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
                    To run the sample, navigate to the following URL:
                </p><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><span class="code">http://localhost/WPFBrowserApplication/WPFBrowserApplication.xbap</span></p></div><h1 class="heading" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><span onclick="ExpandCollapse(sectionToggle5)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle5, event)" tabindex="0">Best Practices</span></h1><div id="sectionSection5" class="section"><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
                    This sample demonstrates a specific feature of the Windows Presentation Foundation and, consequently, does not follow application development best practices. For comprehensive coverage of Windows Presentation Foundation (WPF) and Microsoft .NET Framework application development best practices, refer to the following as appropriate:
                </p><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
                    Accessibility - <span sdata="link">Accessibility Best Practices</span></p><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
                    Localization - <span sdata="link">WPF Globalization and Localization Overview</span></p><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
                    Performance - <span sdata="link">Optimizing WPF Application Performance</span></p><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
                    Security - <span sdata="link">Windows Presentation Foundation Security</span></p></div><h1 class="heading" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><span onclick="ExpandCollapse(sectionToggle6)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle6, event)" tabindex="0">Building the Sample</span></h1><div id="sectionSection6" class="section"><ul xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><li><p>
                    Install the Windows Software Development Kit (SDK) and open its build environment command window. On the Start menu, point to All Programs, Microsoft Windows SDK, and then click CMD Shell.
                </p></li><li><p>
                    Download the sample, usually from the software development kit (SDK) documentation, to your hard disk drive.
                </p></li><li><p>
                    To build the sample from the build environment command window, go to the source directory of the sample. At the command prompt, type MSBUILD.
                </p></li><li><p>
                    To build the sample in Microsoft Visual Studio, load the sample solution or project file and then press CTRL+SHIFT+B.
                </p></li></ul></div><h1 class="heading" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><span onclick="ExpandCollapse(sectionToggle7)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle7, event)" tabindex="0">Running the Sample</span></h1><div id="sectionSection7" class="section"><ul xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><li><p>
                    To run the compiled sample from the build environment command window, execute the .exe file in the Bin\Debug or Bin\Release folder contained under the sample source code folder.
                </p></li><li><p>
                    To run the compiled sample with debugging in Visual Studio, press F5.
                </p></li></ul></div><h1 class="heading" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><span onclick="ExpandCollapse(seeAlsoToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(seeAlsoToggle, event)" tabindex="0">See Also</span></h1><div id="seeAlsoSection" class="section"><h4 class="subHeading" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">Tasks</h4><div class="seeAlsoStyle"><span sdata="link" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">WebBrowser Control Sample</span></div><h4 class="subHeading" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">Concepts</h4><div class="seeAlsoStyle"><span sdata="link" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">Navigation Overview</span></div><div class="seeAlsoStyle"><span sdata="link" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">Structured Navigation Overview</span></div><h4 class="subHeading" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">Reference</h4><div class="seeAlsoStyle"><span sdata="cer" target="T:System.Windows.Controls.WebBrowser" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">WebBrowser</span></div><h4 class="subHeading" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">Other Resources</h4><div class="seeAlsoStyle">Getting Started with Silverlight</div><div class="seeAlsoStyle">Walkthrough: Calling Managed Code from JavaScript</div></div><h1 class="heading" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><span onclick="ExpandCollapse(changeHistoryToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(changeHistoryToggle, event)" tabindex="0">Change History</span></h1><div id="changeHistorySection" class="section"><div class="caption"></div><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><tr><th><p>
                    Date
                </p></th><th><p>
                    History
                </p></th><th><p>
                    Reason
                </p></th></tr><tr><td><p><p>July 2008</p></p></td><td><p>
                    Added sample.
                </p></td><td><p><p>SP1 feature change.</p></p></td></tr></table></div><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"></p></div></div></div></body></html>