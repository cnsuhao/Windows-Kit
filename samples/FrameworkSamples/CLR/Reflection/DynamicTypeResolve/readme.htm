<html><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=utf-8" /><META NAME="save" CONTENT="history" /><title xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">Dynamic Type Resolution Technology Sample</title><META NAME="Description" CONTENT="&#xD;&#xA;                    This sample demonstrates how hosts can participate in the type resolution process by supplying an event handler that returns an assembly containing the requested type. This is an advanced technique, most likely to be used in dis ..."></META><META NAME="MS.LOCALE" CONTENT="en-us" /><style>
body
{font-family:Verdana;font-size:medium;}
div#mainSection, div#header
{font-size:70%;width: 100%;}
div#mainBody
{font-size:90%;}
div#mainSection div table
{font-size: 100%;text-align: left;}
span#nsrTitle
{color:#003399;font-size:90%;font-weight:600;}
div#header
{background-color:#D4DFFF;}
.heading
{font-size:120%;color:#003399;}
.subHeading
{font-size:100%;margin-bottom:4;}
li
{margin-top:-2;margin-bottom:3;}
p
{margin-top:10;margin-bottom:5;}
div.tableSection p
{margin-top:1;margin-bottom:4;}	
div#mainSection table th
{background-color:#EFEFF7;color:#000066;text-align:left;}
div#mainSection table td
{background-color:#F7F7FF;}
div#mainSection table
{margin-top:5px;margin-bottom: px;}
			</style></head><body><div id="header"><table width="100%" id="topTable"></table></div><div id="mainSection"><div id="mainBody"><br /><font color="DarkGray">[This readme is a partial copy of the sample's topic in the SDK documentation.]</font><br /><font color="DarkGray" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"></font><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"></p><div class="introduction"><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
                    This sample demonstrates how hosts can participate in the type resolution process by supplying an event handler that returns an assembly containing the requested type. This is an advanced technique, most likely to be used in distributed applications to facilitate flexibility and fault-tolerance.
                </p><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
                    For information about using the samples, see the following topics:
                </p><ul xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><li><p><span sdata="link">How to: View and Download Samples</span></p></li><li><p><span sdata="link">How to: Set Sample Settings</span></p></li></ul></div><h3 class="procedureSubHeading" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">To build the sample using the command prompt</h3><div class="subSection"><ol xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><li><p>
                    Open a Command Prompt window and navigate to one of the language-specific subdirectories for the sample. 
                </p></li><li><p>
                    Type <span class="input">msbuild DynamicTypeResolveCS.sln</span> or <span class="input">msbuild DynamicTypeResolveVB.sln</span>, depending on your choice of programming language, at the command line. 
                </p></li></ol></div><h3 class="procedureSubHeading" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">To build the sample using Visual Studio</h3><div class="subSection"><ol xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><li><p>
                    Open Windows Explorer and navigate to one of the language-specific subdirectories for the sample.
                </p></li><li><p>
                    Double-click the icon for DynamicTypeResolveCS.sln or DynamicTypeResolveVB.sln, depending on your choice of programming language, to open the file in Visual Studio.
                </p></li><li><p>
                    On the <span class="ui">Build</span> menu, click <span class="ui">Build Solution</span>.
                </p></li></ol></div><h3 class="procedureSubHeading" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">To run the sample</h3><div class="subSection"><ol xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><li><p>
                    Open the Command Prompt window and navigate to the directory that contains the built executable file.
                </p></li><li><p>
                    Type <span class="input">DynamicTypeResolve.exe</span> at the command line. 
                </p></li></ol><div class="alert"><table width="100%" cellspacing="0" cellpadding="0" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><tr><th align="left"><b>Note:</b></th></tr><tr><td><p>
					 The sample builds a console application. You must launch and run it in a Command Prompt window to view its output.
								
								
							</p></td></tr></table></div></div><h1 class="heading" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><span onclick="ExpandCollapse(sectionToggle0)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(sectionToggle0, event)" tabindex="0">Remarks</span></h1><div id="sectionSection0" class="section"><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
                    The sample attempts to instantiate a non-existent type. However, the sample also handles type-load failures, and dynamically creates the necessary type, avoiding a <span sdata="cer" target="T:System.IO.FileNotFoundException">FileNotFoundException</span>. 
                </p><p xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
                    The sample uses the following technologies and classes.
                </p><ul xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><li><p>
                    Reflection 
                </p><ul><li><p><span sdata="cer" target="T:System.AppDomain">AppDomain</span>  The <span sdata="cer" target="E:System.AppDomain.AssemblyResolve">AssemblyResolve</span> event of this class is used to add an event-handler that is called when a type load fails.
                </p></li><li><p><span sdata="cer" target="T:System.Activator">Activator</span> Used to create instances of a type whose name is not necessarily known at compile time.
                </p></li><li><p><span sdata="cer" target="T:System.Reflection.MethodInfo">MethodInfo</span> Used to invoke a method on a type, where the method name is not necessarily known at compile time.
                </p></li><li><p><span sdata="cer" target="T:System.Reflection.Emit.AssemblyBuilder">AssemblyBuilder</span> Used to emit a dynamic assembly at run time.
                </p></li><li><p><span sdata="cer" target="T:System.Reflection.AssemblyName">AssemblyName</span> Used to define the unique identity of an assembly. The sample makes the simplest use of this type, to give the dynamic assembly a text name.
                </p></li><li><p><span sdata="cer" target="T:System.Reflection.Emit.ModuleBuilder">ModuleBuilder</span> Used to build a dynamic module in the dynamic assembly.
                </p></li><li><p><span sdata="cer" target="T:System.Reflection.Emit.TypeBuilder">TypeBuilder</span> This type, derived from <span sdata="cer" target="T:System.Type">Type</span>, is used to build a type dynamically. From it you can request instances of the <span sdata="cer" target="T:System.Reflection.Emit.FieldBuilder">FieldBuilder</span>, <span sdata="cer" target="T:System.Reflection.Emit.ConstructorBuilder">ConstructorBuilder</span>, and <span sdata="cer" target="T:System.Reflection.Emit.MethodBuilder">MethodBuilder</span> types. Using these types, the sample generates a complete type.
                </p></li><li><p><span sdata="cer" target="T:System.Reflection.Emit.MethodBuilder">MethodBuilder</span> Used to define a method in a dynamic type.
                </p></li><li><p><span sdata="cer" target="T:System.Reflection.Emit.ILGenerator">ILGenerator</span>  The <span sdata="cer" target="T:System.Reflection.Emit.MethodBuilder">MethodBuilder</span> type implements the <span sdata="cer" target="Overload:System.Reflection.Emit.MethodBuilder.GetILGenerator">GetILGenerator</span> method, which returns an instance of the <span sdata="cer" target="T:System.Reflection.Emit.ILGenerator">ILGenerator</span> type. This type is used to generate Microsoft Intermediate Language (MSIL) code dynamically.
                </p></li></ul></li><li><p>
                    Delegates and Events 
                </p><ul><li><p><span sdata="cer" target="T:System.ResolveEventHandler">ResolveEventHandler</span> Used to indicate a callback method to be called when a type-resolution fails.
                </p></li></ul></li></ul></div><h1 class="heading" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><span onclick="ExpandCollapse(seeAlsoToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(seeAlsoToggle, event)" tabindex="0">See Also</span></h1><div id="seeAlsoSection" class="section"><h4 class="subHeading" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">Reference</h4><div class="seeAlsoStyle"><span sdata="cer" target="T:System.Activator" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">Activator</span></div><div class="seeAlsoStyle"><span sdata="cer" target="T:System.AppDomain" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">AppDomain</span></div><div class="seeAlsoStyle"><span sdata="cer" target="T:System.Reflection.Emit.AssemblyBuilder" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">AssemblyBuilder</span></div><div class="seeAlsoStyle"><span sdata="cer" target="T:System.Reflection.Emit.AssemblyBuilderAccess" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">AssemblyBuilderAccess</span></div><div class="seeAlsoStyle"><span sdata="cer" target="T:System.Reflection.AssemblyName" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">AssemblyName</span></div><div class="seeAlsoStyle"><span sdata="cer" target="T:System.IO.FileNotFoundException" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">FileNotFoundException</span></div><div class="seeAlsoStyle"><span sdata="cer" target="T:System.Reflection.Emit.ILGenerator" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">ILGenerator</span></div><div class="seeAlsoStyle"><span sdata="cer" target="T:System.Reflection.MethodAttributes" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">MethodAttributes</span></div><div class="seeAlsoStyle"><span sdata="cer" target="T:System.Reflection.Emit.MethodBuilder" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">MethodBuilder</span></div><div class="seeAlsoStyle"><span sdata="cer" target="T:System.Reflection.MethodInfo" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">MethodInfo</span></div><div class="seeAlsoStyle"><span sdata="cer" target="T:System.Reflection.Emit.ModuleBuilder" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">ModuleBuilder</span></div><div class="seeAlsoStyle"><span sdata="cer" target="T:System.ResolveEventHandler" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">ResolveEventHandler</span></div><div class="seeAlsoStyle"><span sdata="cer" target="N:System.IO" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">System.IO</span></div><div class="seeAlsoStyle"><span sdata="cer" target="N:System.Reflection" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">System.Reflection</span></div><div class="seeAlsoStyle"><span sdata="cer" target="N:System.Reflection.Emit" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">System.Reflection.Emit</span></div><div class="seeAlsoStyle"><span sdata="cer" target="T:System.Reflection.Emit.TypeBuilder" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">TypeBuilder</span></div><h4 class="subHeading" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">Other Resources</h4><div class="seeAlsoStyle"><span sdata="link" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">Reflection</span></div><div class="seeAlsoStyle"><span sdata="link" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">Emitting Dynamic Methods and Assemblies</span></div><div class="seeAlsoStyle"><span sdata="link" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">Dynamic Source Code Generation and Compilation</span></div><div class="seeAlsoStyle"><span sdata="link" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">Handling and Raising Events</span></div><div class="seeAlsoStyle"><span sdata="link" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:msxsl="urn:schemas-microsoft-com:xslt">Managed and Unmanaged Events</span></div></div></div></div></body></html>